-- Distributed Databases - Assignment 02
-- HS-Fulda SoSe 17
-- @author  Manasés Jesús (;

DROP TABLE R1K;

CREATE TABLE R1K (
  PK       INTEGER GENERATED ALWAYS AS IDENTITY (START WITH 1 INCREMENT BY 1) PRIMARY KEY,
  CK1      INTEGER,
  FK       INTEGER,
  FIBO     INTEGER NOT NULL,
  GV100    INTEGER NOT NULL,
  GV10000  INTEGER NOT NULL,
  UV30     INTEGER NOT NULL,
  LV1000   INTEGER,
  STADT100 VARCHAR2(21) NOT NULL,
  DAT100   DATE NOT NULL,
  TODAY    DATE DEFAULT SYSDATE NOT NULL,


  CONSTRAINT R1K_ck1_check CHECK ((CK1 > 0 AND CK1 IS NOT NULL AND PK*3 = CK1 AND MOD(PK,5) != 0) OR (MOD(PK,5) = 0 AND CK1 IS NULL)),
  CONSTRAINT R1K_fk_refers_pk FOREIGN KEY (FK) REFERENCES R1K (PK),
  CONSTRAINT R1K_fk_check CHECK ((FK = MOD(PK,10) AND FK != 0 AND FK IS NOT NULL) OR (FK IS NULL AND MOD(PK,10) = 0)),

  CONSTRAINT R1K_fibo_check CHECK (FIBO > 0),
  CONSTRAINT R1K_gv100_check CHECK (GV100 >= 1 AND GV100 <= 100),
  CONSTRAINT R1K_gv10000_check CHECK (GV10000 >= 1 AND GV10000 <= 10000),
  CONSTRAINT R1K_uv30_check CHECK (UV30 >= 1 AND UV30 <= 29),
  CONSTRAINT R1K_lv1000_check CHECK ((LV1000 >= 1 AND LV1000 <= 1000) OR LV1000 IS NULL),

  CONSTRAINT R1K_date_check CHECK (DAT100 > TODAY-1 AND DAT100 < TODAY+100)
);
